---
import { getCollection } from "astro:content";
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
    const prints = (await getCollection('prints'))
    return prints.map((print) => {
        return {
            params: { slug: print.id},
            props: { print },
        };
    });
}


const { print } = Astro.props;

const images = import.meta.glob<{ default: ImageMetadata }>('/src/assets/prints/*.{webp,jpeg,jpg,png,gif}');

const imagePath = print.data.image
if (!images[imagePath]) throw new Error(`"${imagePath}" does not exist in glob: "src/assets/prints/*.{webp,jpeg,jpg,png,gif}"`);

---

<Layout title="Available prints">
	<main>
		<h1>{print.data.name}</h1>
        <Image src={images[imagePath]()} alt="The 3d print"></Image>
	</main>
</Layout>

<style>
    h1 {
		color:  var(--white);
		background-color: var(--black);
		text-align: center;
		padding: 20px;
	}

    img {
        width: 500px;
        height: 350px;
    }

</style>
